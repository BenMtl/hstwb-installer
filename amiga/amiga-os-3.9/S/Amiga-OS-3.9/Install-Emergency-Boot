; Install Emergency Boot
; ----------------------
;
; Date: 2018-12-23
; Author: Henrik Noerfjand Stengaard
;
; AmigsDOS script to install Emergency Boot for Amiga OS 3.9 installation.


; emergency boot installation message
cls 
echo "*e[32m" NOLINE
echo "Amiga OS 3.9 Emergency Boot Installation"
echo "*e[0m*e[1m" NOLINE
echo "----------------------------------------"
echo "*e[0m" NOLINE
echo ""

; goto end, if "AmigaOS3.9:" device doesn't exist
Assign >NIL: EXISTS AmigaOS3.9:
IF NOT $RC EQ 0 VAL
  echo "*e[1mERROR: Device AmigaOS3.9: doesn't exist!*e[22m"
  SKIP fail
ENDIF

; copy emergency boot
echo "*e[1mInstalling Emergency Boot for Amiga OS 3.9 installation*e[0m"
echo "Copying Emergency Boot..."

; copy emergency boot files to systemdir
Copy >NIL: AmigaOS3.9:EMERGENCY-BOOT SYSTEMDIR: ALL

; delete disk.info icon from systemdir, if it exists
IF EXISTS SYSTEMDIR:Disk.info
  Delete >NIL: SYSTEMDIR:Disk.info
ENDIF

; copy assign hstwb installer for installing boing bags
Copy >NIL: INSTALLDIR:S/Assign-HstWB-Installer SYSTEMDIR:S

; replace workbench startup-sequence with Amiga OS 3.9 startup-sequence
Rename >NIL: SYSTEMDIR:S/Startup-Sequence SYSTEMDIR:S/Startup-Sequence.Emergency-Boot
Copy >NIL: INSTALLDIR:S/Amiga-OS-3.9/Startup-Sequence.AmigaOS3.9 SYSTEMDIR:S/Startup-Sequence


; done message
echo "Done"
echo ""
echo "Emergency Boot installation is complete."

SKIP end


; fail
; ----
LAB fail

echo ""
echo "Emergency Boot installation failed and has stopped"
echo "installation process."
echo ""
echo "Restart to rerun installation process."
quit


; end
; ---
LAB end

echo ""
ask "Press ENTER to continue"
