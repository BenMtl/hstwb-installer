; Startup Sequence for HstWB Installer
; ------------------------------------
;
; Date: 2017-09-27
; Author: Henrik Noerfjand Stengaard


; Load patched scsi.device v43.45
LoadModule DEVS:scsi.device


; Add alias
Alias cls "Echo NOLINE *"*E[0;0H*E[J*" " 


; Startup message
cls 
echo "*e[32m" NOLINE
echo "HstWB Installer"
echo "*e[0m*e[1m" NOLINE
echo "---------------"
echo "*e[0m" NOLINE
echo ""
echo "HstWB Installer is now running install..."


; Set stack, failat and load basic commands resident 
stack 16384
failat 21
DF0:C/AddBuffers >NIL: DF0: 200
resident DF0:C/Assign PURE
resident DF0:C/Copy PURE
resident DF0:C/Delete PURE
resident DF0:C/Eval PURE
resident DF0:C/Execute PURE
resident DF0:C/Rename PURE
resident DF0:C/MakeDir PURE
resident DF0:C/Protect PURE
resident DF0:C/Search PURE 
resident DF0:C/Wait PURE 
resident DF0:C/Which PURE 
resident DF0:C/Mount PURE
resident DF0:C/Type PURE
resident DF0:C/Version PURE
resident DF0:C/RequestChoice PURE
MakeDir RAM:Clipboards RAM:ENV RAM:ENV/Sys
Assign ENV: RAM:Env
Assign T: RAM:
SetEnv TZ MST7


wait 1


; Fail, if assign hstwb installer doesn't exist
IF NOT EXISTS S:Assign-HstWB-Installer
  echo "" >INSTALLDIR:Error
  echo "Error: assign hstwb installer doesn't exist!"
  SKIP fail
ENDIF
execute S:Assign-HstWB-Installer


; Install HstWB Installer Packages
IF EXISTS INSTALLDIR:HstWB-Installer.Packages.ini
  makepath >NIL: SYSTEMDIR:Prefs/Env-Archive
  copy >NIL: INSTALLDIR:HstWB-Installer.Packages.ini SYSTEMDIR:Prefs/Env-Archive/HstWB-Installer.Packages.ini
ENDIF


; Install HstWB Installer Assigns
IF EXISTS INSTALLDIR:HstWB-Installer.Assigns.ini
  makepath >NIL: SYSTEMDIR:Prefs/Env-Archive
  copy >NIL: INSTALLDIR:HstWB-Installer.Assigns.ini SYSTEMDIR:Prefs/Env-Archive/HstWB-Installer.Assigns.ini
ENDIF


; Run prepare install
execute "INSTALLDIR:S/Prepare-Install"


; Run install start
execute "INSTALLDIR:S/Install-Start"


; Run install complete
execute "INSTALLDIR:S/Install-Complete"

SKIP end


; Fail
LAB fail
echo ""
echo "Installation failed."
quit


; End
LAB end