; Install Amiga OS 3.1.4
; ----------------------
;
; Date: 2019-07-22
; Author: Henrik Noerfjand Stengaard
;
; AmigaDOS script to automate installation of Amiga OS 3.1.4 from adf files or floppy disks.


; amiga os 3.1.4 installation message
cls
echo "*e[32m" NOLINE
echo "Amiga OS 3.1.4 Installation"
echo "*e[0m*e[1m" NOLINE
echo "---------------------------"
echo "*e[0m" NOLINE 
echo ""

; glow icons
setenv glowicons `RequestChoice "Install Glow Icons" "Amiga OS 3.1.4 comes with a colorful and*Nprofessionally designed icon set called Glow Icons.*N*NDo you want to install Amiga OS 3.1.4 Glow Icons?*N*NNote that Glow Icons might be overwritten, if*NClassicWB, BestWB, BetterWB or HstWB packages*Nare installed." "Yes|No"`
IF "$glowicons" EQ 1 VAL
  echo "$glowicons" NOLINE >INSTALLDIR:Prefs/Amiga-OS-3.1.4-GlowIcons

  ; screenmode
  IF "$palmonitor" EQ 1 VAL
    setenv screenmode `RequestChoice "Update Screenmode" "Glow Icons looks best with interlaced screenmode.*N*NDo you want to update screenmode prefs with display mode*Nset to *"PAL 640 x 512, 256 colors*"?*N*NNote that screenmode prefs might be overwritten, if*NClassicWB, BestWB, BetterWB or HstWB packages*Nare installed." "Yes|No"`
  ELSE
    setenv screenmode `RequestChoice "Update Screenmode" "Glow Icons looks best with interlaced screenmode.*N*NDo you want to update screenmode prefs with display mode*Nset to *"NTSC 640 x 400, 256 colors*"?*N*NNote that screenmode prefs might be overwritten, if*NClassicWB, BestWB, BetterWB or HstWB packages*Nare installed." "Yes|No"`
  ENDIF
ENDIF


; copy patch amiga os 3.1.4.1 files
MakePath >NIL: "SYSTEMDIR:S"
Copy >NIL: "INSTALLDIR:Extras/Amiga-OS-3141-Startup" "SYSTEMDIR:S"
Copy >NIL: "INSTALLDIR:Extras/Install-Patch-Amiga-OS-3141" "SYSTEMDIR:S"
Copy >NIL: "INSTALLDIR:Extras/Patch-Amiga-OS-3141" "SYSTEMDIR:S"

; run install amiga os 3.1.4 adf, if prefs exists. otherwise run install amiga os 3.1.4 disk
fsearch INSTALLDIR:Prefs PAT "Install-Amiga-OS-314-#?-ADF" >T:_install_amiga-os-314
IF "`wc -l <T:_install_amiga-os-314`" GT 0 VAL
  ; run install amiga os 3.1.4 adf
  execute "INSTALLDIR:S/Amiga-OS-3.1.4/Install-Adf"
ELSE
  ; run install amiga os 3.1.4 disk
  execute "INSTALLDIR:S/Amiga-OS-3.1.4/Install-Disk"
ENDIF 

; install amiga os 3.1.4 icon pack, if prefs exists
IF EXISTS "INSTALLDIR:Prefs/Install-Amiga-OS-314-IconPack"
  ; install amiga os 3.1.4 from adf files message
  echo ""
  echo "*e[1mInstall Amiga OS 3.1.4 support files:*e[0m"

  ; amiga os 3.1.4 icon pack message
  echo "Amiga OS 3.1.4 Icon Pack..."

  IF NOT EXISTS "SYSTEMDIR:Icons/"
    MakePath >NIL: SYSTEMDIR:Icons
  ENDIF
  lha -q -m1 x "INSTALLDIR:Temp/Amiga-OS/amiga-os-314-iconpack.lha" "SYSTEMDIR:Icons/"

  echo "Done"
ENDIF

; create amiga os 3.1.4 prefs
echo "" NOLINE >INSTALLDIR:Prefs/Amiga-OS-3.1.4

echo ""
echo "Amiga OS 3.1.4 installation is complete."
echo ""
ask "Press ENTER to continue"
