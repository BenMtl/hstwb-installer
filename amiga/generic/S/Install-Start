; Install Start
; -------------
;
; Date: 2018-12-12
; Author: Henrik Noerfjand Stengaard
;
; An AmigaDOS script to start installation of Large Harddisk, Amiga OS 3.9, 3.1.4 or 3.1, Kickstarts and packages.


; detect pal or ntsc monitor
setenv palmonitor "1"
INSTALLDIR:C/paltest >T:_paltest
search >NIL: T:_paltest "PAL  (256/512 lines)"
IF NOT $RC EQ 0 VAL
  setenv palmonitor "0"
ENDIF
Delete >NIL: T:_paltest

; Copy large harddisk, if install large harddisk exists
IF EXISTS "INSTALLDIR:Install-LargeHarddisk"
  copy >NIL: "INSTALLDIR:Install-LargeHarddisk/" TO "SYSTEMDIR:" ALL
ENDIF

; run install amiga os 3.9, if prefs exists
fsearch INSTALLDIR:Prefs PAT "Install-Amiga-OS-390#?" >T:_install_amiga-os-390
IF "`wc -l <T:_install_amiga-os-390`" GT 0 VAL
  execute "INSTALLDIR:S/Amiga-OS-3.9/Install-Amiga-OS-3.9"
ELSE
  ; run install amiga os 3.1.4, if prefs exists
  fsearch INSTALLDIR:Prefs PAT "Install-Amiga-OS-314-#?-ADF" >T:_install_amiga-os-314
  IF "`wc -l <T:_install_amiga-os-314`" GT 0 VAL
    execute "INSTALLDIR:S/Amiga-OS-3.1.4/Install-Amiga-OS-3.1.4"
  ELSE
    ; run install amiga os 3.1, if prefs exists
    fsearch INSTALLDIR:Prefs PAT "Install-Amiga-OS-310#?" >T:_install_amiga-os-310
    IF "`wc -l <T:_install_amiga-os-310`" GT 0 VAL
      execute "INSTALLDIR:S/Amiga-OS-3.1/Install-Amiga-OS-3.1"
    ELSE
      ; run detect amiga os disk
      execute "INSTALLDIR:S/Detect-Amiga-OS-Disk"
    ENDIF
  ENDIF
ENDIF
Delete >NIL: T:_install_amiga-os-390
Delete >NIL: T:_install_amiga-os-314
Delete >NIL: T:_install_amiga-os-310

; Install Kickstart, if prefs exists
IF EXISTS "INSTALLDIR:Prefs/Install-Kickstart"
  execute "INSTALLDIR:S/Install-Kickstart"
ENDIF

; Install Emergency Boot, if install amiga os 3.9 prefs exists
IF EXISTS "INSTALLDIR:Prefs/Install-Amiga-OS-3.9"
  execute "INSTALLDIR:S/Install-Emergency-Boot"
ENDIF