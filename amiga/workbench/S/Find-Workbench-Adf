; Find Workbench Adf
; ------------------
;
; Date: 2017-08-03
; Author: Henrik Noerfjand Stengaard


; Find Workbench adf files
echo ""
echo "Finding Workbench adf files in WORKBENCHDIR:"
fsearch WORKBENCHDIR:#?.adf >T:workbench-adf-files1
sed "s/^\(.\)/execute *"INSTALLDIR:S\/Copy-Workbench-Adf*" *"\1/" T:workbench-adf-files1 >T:workbench-adf-files2
sed "s/\(.\)$/\1*" *"INSTALLDIR:Workbench\/*"/" T:workbench-adf-files2 >T:workbench-adf-files3
execute T:workbench-adf-files3


; Set fallback to 1, if one or more workbench adf files doesn't exist
set installworkbenchadf "1"
IF NOT EXISTS "INSTALLDIR:Workbench/workbench31workbench.adf"
  ECHO "Workbench 3.1 Workbench adf doesn't exist!"
  set installworkbenchadf "0"
ENDIF
IF NOT EXISTS "INSTALLDIR:Workbench/workbench31locale.adf"
  ECHO "Workbench 3.1 Locale adf doesn't exist!"
  set installworkbenchadf "0"
ENDIF
IF NOT EXISTS "INSTALLDIR:Workbench/workbench31extras.adf"
  ECHO "Workbench 3.1 Extras adf doesn't exist!"
  set installworkbenchadf "0"
ENDIF
IF NOT EXISTS "INSTALLDIR:Workbench/workbench31fonts.adf"
  ECHO "Workbench 3.1 Fonts adf doesn't exist!"
  set installworkbenchadf "0"
ENDIF
IF NOT EXISTS "INSTALLDIR:Workbench/workbench31install.adf"
  ECHO "Workbench 3.1 Install adf doesn't exist!"
  set installworkbenchadf "0"
ENDIF
IF NOT EXISTS "INSTALLDIR:Workbench/workbench31storage.adf"
  ECHO "Workbench 3.1 Storage adf doesn't exist!"
  set installworkbenchadf "0"
ENDIF


echo "Done"


; Create install workbench adf, if install workbench adf is 1. Otherwise show install workbench from disk fallback message
IF $installworkbenchadf EQ "1" VAL
  echo "" >INSTALLDIR:Prefs/Install-Workbench-Adf
ELSE
  echo ""
  echo "Not all Workbench adf files exists. Installation will"
  echo "fallback to install Workbench from disks."
  echo ""
  echo "It's also possible to change directory for WORKBENCHDIR"
  echo "and reset to retry installing Workbench from adf files"
  echo "again."
  echo ""
  ask "Press ENTER to continue"
ENDIF